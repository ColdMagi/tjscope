"use strict";(self.webpackChunktjscope=self.webpackChunktjscope||[]).push([[482],{4482:function(e,n,r){r.r(n),r.d(n,{default:function(){return A}});var s=r(3433),t=r(1413),i=r(9439),l=r(7762),o=r(9712),u=r(5443),d=r(7552),c=r(1089),a=r(2157),x=r(4827),h=r(184);var v=function(e){var n=e.value;return(0,h.jsx)(h.Fragment,{children:n?"\u0414\u0430":"\u041d\u0435\u0442"})},j=r(2804);var m=function(e){var n=e.comment,r=n.author,s=r.avatar_url,t=r.name,i=n.date,l=n.likes,u=l.count,d=l.summ,c=n.id,x=n.entry.url,v=n.html;return(0,h.jsxs)(o.gC,{align:"flex-start",as:"a",href:x+"?comment=".concat(c),rel:"nofollow noopener noreferrer",target:"_blank",p:"3",shadow:"md",borderWidth:"1px",rounded:"md",minW:"100%",spacing:3,children:[(0,h.jsxs)(o.Ug,{justifyContent:"space-between",minW:"100%",children:[(0,h.jsxs)(o.Ug,{children:[(0,h.jsx)(a.qE,{size:"xs",src:s,name:t}),(0,h.jsx)(o.X6,{size:"sm",children:t})]}),(0,h.jsx)(o.xv,{color:"gray.400",as:"time",children:(0,j.Z)(1e3*i,"dd.LL.yy")})]}),(0,h.jsx)(o.gC,{pl:"8",children:(0,h.jsx)(o.xv,{dangerouslySetInnerHTML:{__html:v}})}),(0,h.jsxs)(o.Ug,{justifyContent:"space-between",minW:"100%",children:[(0,h.jsx)("span",{}),(0,h.jsxs)(o.Ug,{children:[(0,h.jsx)(o.xv,{color:"red.300",children:u-d}),(0,h.jsx)(o.xv,{color:"green.300",children:d})]})]})]})},f=r(4828);var g=function(e){var n=e.entry,r=n.url,s=n.hitsCount,t=n.intro,i=n.date,l=n.likes,u=l.count,d=l.summ,c=n.cover,x=n.subsite,v=x.avatar_url,m=x.name;return(0,h.jsxs)(o.gC,{align:"flex-start",as:"a",href:r,rel:"nofollow noopener noreferrer",target:"_blank",p:"3",shadow:"md",borderWidth:"1px",rounded:"md",minW:"100%",spacing:3,children:[(0,h.jsxs)(o.Ug,{justifyContent:"space-between",minW:"100%",children:[(0,h.jsxs)(o.Ug,{children:[(0,h.jsx)(a.qE,{size:"xs",src:v,name:m}),(0,h.jsx)(o.X6,{size:"sm",children:m})]}),(0,h.jsx)(o.xv,{color:"gray.400",as:"time",children:(0,j.Z)(1e3*i,"dd.LL.yy")})]}),(0,h.jsxs)(o.gC,{pl:"8",children:[(0,h.jsx)(o.xv,{children:t}),c&&(0,h.jsx)(f.Ee,{src:c.thumbnailUrl,alt:"",objectFit:"contain",pointerEvents:"none"})]}),(0,h.jsxs)(o.Ug,{justifyContent:"space-between",minW:"100%",children:[(0,h.jsxs)(o.xv,{pl:"8",color:"gray.400",children:[s," \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432"]}),(0,h.jsxs)(o.Ug,{children:[(0,h.jsx)(o.xv,{color:"red.300",children:u-d}),(0,h.jsx)(o.xv,{color:"green.300",children:d})]})]})]})};var p=function(e){var n=e.label,r=void 0===n?"\u0420\u0435\u0439\u0442\u0438\u043d\u0433":n,s=e.children;return(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:r}),(0,h.jsx)(u.Jf,{color:"gray.500",children:s})]})},k=r(811),b=r(4165),y=r(5861),w=r(2791),C="https://api.tjournal.ru/v2.31",Z=(0,w.createContext)(C),N=function(){return(0,w.useContext)(Z)};function L(e,n){var r=(0,w.useRef)({}),s=(0,w.useRef)(!1),l={error:void 0,data:void 0},o=(0,w.useReducer)((function(e,n){switch(n.type){case"loading":return(0,t.Z)({},l);case"fetched":return(0,t.Z)((0,t.Z)({},l),{},{data:n.payload});case"error":return(0,t.Z)((0,t.Z)({},l),{},{error:n.payload});default:return e}}),l),u=(0,i.Z)(o,2),d=u[0],c=u[1];return(0,w.useEffect)((function(){if(e){s.current=!1;var t=function(){var t=(0,y.Z)((0,b.Z)().mark((function t(){var i,l;return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c({type:"loading"}),!r.current[e]){t.next=4;break}return c({type:"fetched",payload:r.current[e]}),t.abrupt("return");case 4:return t.prev=4,t.next=7,fetch(e,n);case 7:if((i=t.sent).ok){t.next=10;break}throw new Error(i.statusText);case 10:return t.next=12,i.json();case 12:if(l=t.sent,r.current[e]=l,!s.current){t.next=16;break}return t.abrupt("return");case 16:c({type:"fetched",payload:l}),t.next=24;break;case 19:if(t.prev=19,t.t0=t.catch(4),!s.current){t.next=23;break}return t.abrupt("return");case 23:c({type:"error",payload:t.t0});case 24:case"end":return t.stop()}}),t,null,[[4,19]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){s.current=!0}}}),[e]),d}function T(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2.31",s=N();return L(e?"".concat(s.replace("2.31",r)).concat(e):e,n)}function W(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2.31",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,o=(0,w.useState)({result:[]}),u=(0,i.Z)(o,2),d=u[0],c=u[1],a=(0,w.useState)(0),x=(0,i.Z)(a,2),h=x[0],v=x[1],j=T(e+"?count=".concat(l,"&offset=").concat(h),n,r),m=j.data;return(0,w.useEffect)((function(){if(m&&(c((function(e){return(0,t.Z)((0,t.Z)((0,t.Z)({},e),m),{},{result:[].concat((0,s.Z)(e.result),(0,s.Z)(m.result))})})),m.result.length>=l)){var e=setTimeout((function(){return v((function(e){return e+l}))}),2e3);return function(){return clearTimeout(e)}}}),[m,l]),d}var _=r(3504),D=r(3859);function J(e){var n,r,s,t,i=e.subsite,l=e.entries,d=e.comments;return(0,h.jsxs)(o.gC,{divider:(0,h.jsx)(o.cX,{}),children:[(0,h.jsxs)(o.MI,{columns:4,spacing:3,children:[(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041f\u043e\u0441\u0442\u043e\u0432"}),(0,h.jsx)(u.Jf,{children:(null===i||void 0===i||null===(n=i.counters)||void 0===n?void 0:n.entries)||l||"N/A"})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432"}),(0,h.jsx)(u.Jf,{children:(null===i||void 0===i||null===(r=i.counters)||void 0===r?void 0:r.comments)||d||"N/A"})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041f\u043e\u0434\u043f\u0438\u0441\u043e\u043a"}),(0,h.jsx)(u.Jf,{children:(null===i||void 0===i||null===(s=i.counters)||void 0===s?void 0:s.subscriptions)||"N/A"})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u043e\u0432"}),(0,h.jsx)(u.Jf,{children:(null===i||void 0===i||null===(t=i.counters)||void 0===t?void 0:t.subscribers)||"N/A"})]})]}),(0,h.jsxs)(o.MI,{columns:2,spacing:3,justifyContent:"space-between",minW:"100%",children:[(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"Plus"}),(0,h.jsx)(u.Jf,{children:(0,h.jsx)(v,{value:null===i||void 0===i?void 0:i.isPlus})})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d"}),(0,h.jsx)(u.Jf,{children:(0,h.jsx)(v,{value:null===i||void 0===i?void 0:i.isVerified})})]})]})]})}function U(e){var n=e.label,r=e.children;return(0,h.jsxs)(o.gC,{align:"flex-start",minW:"100%",children:[(0,h.jsx)(o.X6,{size:"md",children:n}),r]})}function E(e){var n=e.data,r=(0,w.useMemo)((function(){var e,r={rating:0,ratingCount:0,comments:0,reposts:0,hits:0,mostHits:((null===n||void 0===n?void 0:n.result)||[])[0],mostLiked:((null===n||void 0===n?void 0:n.result)||[])[0],mostDisliked:((null===n||void 0===n?void 0:n.result)||[])[0]},s=(0,l.Z)((null===n||void 0===n?void 0:n.result)||[]);try{for(s.s();!(e=s.n()).done;){var t=e.value;r.rating+=t.likes.summ,r.ratingCount+=t.likes.count,r.comments+=t.commentsCount,r.reposts+=Number(t.isRepost),r.hits+=t.hitsCount,t.hitsCount>r.mostHits.hitsCount&&(r.mostHits=t),t.likes.summ>r.mostLiked.likes.summ&&(r.mostLiked=t),t.likes.count-t.likes.summ>r.mostDisliked.likes.count-r.mostDisliked.likes.summ&&(r.mostDisliked=t)}}catch(i){s.e(i)}finally{s.f()}return r}),[n]);return(0,h.jsxs)(o.gC,{align:"flex-start",w:"100%",pl:"2",spacing:4,children:[(0,h.jsxs)(o.MI,{columns:3,spacing:1,justifyContent:"space-between",minW:"100%",children:[(0,h.jsx)(p,{children:r.rating}),(0,h.jsx)(p,{label:"\u041e\u0446\u0435\u043d\u043e\u043a",children:r.ratingCount}),(0,h.jsx)(p,{label:"\u041e\u0446\u0435\u043d\u043a\u0438 [\u043c\u0438\u043d\u0443\u0441]",children:r.ratingCount-r.rating}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432"}),(0,h.jsx)(u.Jf,{children:r.comments})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432"}),(0,h.jsx)(u.Jf,{children:r.hits})]}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u0420\u0435\u043f\u043e\u0441\u0442\u043e\u0432"}),(0,h.jsx)(u.Jf,{children:r.reposts})]})]}),r.mostHits&&(0,h.jsx)(U,{label:"\u041d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u043c\u044b\u0439",children:(0,h.jsx)(g,{entry:r.mostHits})}),r.mostLiked&&(0,h.jsx)(U,{label:"\u041d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043b\u044e\u0441\u043e\u0432",children:(0,h.jsx)(g,{entry:r.mostLiked})}),r.mostDisliked&&(0,h.jsx)(U,{label:"\u041d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0438\u043d\u0443\u0441\u043e\u0432",children:(0,h.jsx)(g,{entry:r.mostDisliked})})]})}function z(e){var n=e.data,r=(0,w.useMemo)((function(){var e,r={rating:0,ratingCount:0,mostLiked:((null===n||void 0===n?void 0:n.result)||[])[0],mostDisliked:((null===n||void 0===n?void 0:n.result)||[])[0]},s=(0,l.Z)((null===n||void 0===n?void 0:n.result)||[]);try{for(s.s();!(e=s.n()).done;){var t=e.value;r.rating+=t.likes.summ,r.ratingCount+=t.likes.count,t.likes.summ>r.mostLiked.likes.summ&&(r.mostLiked=t),t.likes.count-t.likes.summ>r.mostDisliked.likes.count-r.mostDisliked.likes.summ&&(r.mostDisliked=t)}}catch(i){s.e(i)}finally{s.f()}return r}),[n]);return(0,h.jsxs)(o.gC,{align:"flex-start",w:"100%",pl:"2",spacing:4,children:[(0,h.jsxs)(o.MI,{columns:3,spacing:1,justifyContent:"space-between",minW:"100%",children:[(0,h.jsx)(p,{children:r.rating}),(0,h.jsx)(p,{label:"\u041e\u0446\u0435\u043d\u043e\u043a",children:r.ratingCount}),(0,h.jsx)(p,{label:"\u041e\u0446\u0435\u043d\u043a\u0438 [\u043c\u0438\u043d\u0443\u0441]",children:r.ratingCount-r.rating})]}),r.mostLiked&&(0,h.jsx)(U,{label:"\u041d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043b\u044e\u0441\u043e\u0432",children:(0,h.jsx)(m,{comment:r.mostLiked})}),r.mostDisliked&&(0,h.jsx)(U,{label:"\u041d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0438\u043d\u0443\u0441\u043e\u0432",children:(0,h.jsx)(m,{comment:r.mostDisliked})})]})}function M(e){var n,r,l=e.comments,u=(0,w.useState)({}),x=(0,i.Z)(u,2),v=x[0],j=x[1],m=(0,w.useState)(0),f=(0,i.Z)(m,2),g=f[0],p=f[1],k=T("/comment/likers/".concat(null===(n=((null===l||void 0===l?void 0:l.result)||[])[g])||void 0===n?void 0:n.id),void 0,"1.9").data;return(0,w.useEffect)((function(){if(k){j((function(e){for(var n=(0,t.Z)({},e),r=0,s=Object.entries(k.result);r<s.length;r++){var l=(0,i.Z)(s[r],2),o=l[0],u=l[1];Reflect.has(n,o)||(n[o]={total:0,minus:0,plus:0,avatar_url:"",name:""}),n[o].total+=Math.abs(u.sign),n[o].minus+=Number(u.sign<0),n[o].plus+=Number(u.sign>0),n[o].avatar_url=u.avatar_url,n[o].name=u.name}return n}));var e=setTimeout((function(){return p((function(e){return e+1}))}),2e3);return function(){return clearTimeout(e)}}}),[k]),(0,h.jsxs)(o.gC,{position:"relative",children:[(null===l||void 0===l||null===(r=l.result)||void 0===r?void 0:r.length)>g&&(0,h.jsx)(d.Ex,{size:"xs",isIndeterminate:!0,w:"100%"}),(0,h.jsx)(c.xJ,{children:(0,h.jsxs)(c.iA,{variant:"simple",children:[(0,h.jsx)(c.Rn,{children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043e\u0446\u0435\u043d\u043e\u043a \u043f\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c"}),(0,h.jsx)(c.hr,{children:(0,h.jsxs)(c.Tr,{children:[(0,h.jsx)(c.Th,{children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"}),(0,h.jsx)(c.Th,{isNumeric:!0,children:"\u041f\u043b\u044e\u0441"}),(0,h.jsx)(c.Th,{isNumeric:!0,children:"\u041c\u0438\u043d\u0443\u0441"}),(0,h.jsx)(c.Th,{isNumeric:!0,children:"\u0412\u0441\u0435\u0433\u043e"})]})}),(0,h.jsx)(c.p3,{children:(0,s.Z)(Object.entries(v)).map((function(e){var n=(0,i.Z)(e,2),r=n[0],s=n[1],t=s.name,l=s.avatar_url,u=s.minus,d=s.plus,x=s.total;return(0,h.jsxs)(c.Tr,{children:[(0,h.jsx)(c.Td,{children:(0,h.jsxs)(o.Ug,{as:"a",href:"https://tjournal.ru/u/".concat(r),target:"_blank",children:[(0,h.jsx)(a.qE,{name:t,src:l}),(0,h.jsx)(o.xv,{as:"b",maxW:"200px",textOverflow:"ellipsis",overflow:"hidden",children:t})]})}),(0,h.jsx)(c.Td,{children:x}),(0,h.jsx)(c.Td,{children:u}),(0,h.jsx)(c.Td,{children:d})]},r)}))})]})})]})}function X(e){var n,r,s,t,i=e.subsite,l=e.avatar_url,d=e.rating;return(0,h.jsxs)(o.Ug,{spacing:10,position:"sticky",top:"0",bg:"white",zIndex:"1000",pt:"5",pb:"2",px:"4",children:[(0,h.jsx)(a.qE,{name:i.name,size:"2xl",src:null!==i&&void 0!==i&&null!==(n=i.avatar)&&void 0!==n&&null!==(r=n.data)&&void 0!==r&&r.uuid?"https://leonardo.osnova.io/".concat(null===i||void 0===i||null===(s=i.avatar)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.uuid,"/-/scale_crop/300x300/-/format/webp/"):l}),(0,h.jsxs)(o.gC,{children:[(0,h.jsx)(o.X6,{size:"lg",children:i.name}),(0,h.jsxs)(o.Ug,{justifyContent:"space-between",minW:"100%",children:[(0,h.jsx)(p,{children:i.rating||d||"N/A"}),(0,h.jsxs)(u.kN,{children:[(0,h.jsx)(u.dw,{children:"\u0421\u043e\u0437\u0434\u0430\u043d"}),(0,h.jsx)(u.Jf,{children:(0,k.Z)(i.created)?(0,j.Z)(1e3*i.created,"dd.LL.yy"):"N/A"})]})]})]})]})}var A=function(){var e,n,r,s,t,l,u,d,c,a,v,j,m,f,g=(0,_.lr)(),p=(0,i.Z)(g,1)[0],k=(0,D.s)(p.get("id")||""),b=T("/subsite?id=".concat(k)),y=b.data,C=b.error,Z=W("/user/".concat(k,"/entries"),void 0,"1.9"),N=W("/user/".concat(k,"/comments"),void 0,"1.9"),L=(0,w.useMemo)((function(){var e;return null===Z||void 0===Z||null===(e=Z.result)||void 0===e?void 0:e.reduce((function(e,n){return e+n.likes.summ}),0)}),[Z]),U=(0,w.useMemo)((function(){var e;return null===N||void 0===N||null===(e=N.result)||void 0===e?void 0:e.reduce((function(e,n){return e+n.likes.summ}),0)}),[N]),A=(y||{result:{subsite:{name:(null===N||void 0===N||null===(e=N.result)||void 0===e||null===(n=e.at(0))||void 0===n||null===(r=n.author)||void 0===r?void 0:r.name)||(null===Z||void 0===Z||null===(s=Z.result)||void 0===s||null===(t=s.at(0))||void 0===t||null===(l=t.author)||void 0===l?void 0:l.name)}}}).result.subsite;return(0,h.jsxs)(o.gC,{align:"start",children:[C&&(0,h.jsxs)(o.gC,{align:"start",children:[(0,h.jsx)(o.X6,{children:"\u0412\u0435\u0440\u043e\u044f\u0442\u043d\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0437\u0430\u043a\u0440\u044b\u0442 \u0438\u043b\u0438 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}),(0,h.jsx)(o.xv,{fontSize:"12px",color:"gray.500",children:"\u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u0435\u0435 \u0442\u043e\u0447\u043d\u044b \u0438 \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0430"})]}),(0,h.jsx)(X,{subsite:A,avatar_url:(null===N||void 0===N||null===(u=N.result)||void 0===u||null===(d=u.at(0))||void 0===d||null===(c=d.author)||void 0===c?void 0:c.avatar_url)||(null===Z||void 0===Z||null===(a=Z.result)||void 0===a||null===(v=a.at(0))||void 0===v||null===(j=v.author)||void 0===j?void 0:j.avatar_url),rating:L+U}),(0,h.jsxs)(x.mQ,{variant:"enclosed",children:[(0,h.jsxs)(x.td,{children:[(0,h.jsx)(x.OK,{children:"\u041e\u0431\u0437\u043e\u0440"}),(0,h.jsx)(x.OK,{children:"\u041f\u043e\u0441\u0442\u044b"}),(0,h.jsx)(x.OK,{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"}),(0,h.jsx)(x.OK,{children:"\u0418\u0442\u043e\u0433"})]}),(0,h.jsxs)(x.nP,{children:[(0,h.jsx)(x.x4,{children:(0,h.jsx)(J,{subsite:A,entries:null===Z||void 0===Z||null===(m=Z.result)||void 0===m?void 0:m.length,comments:null===N||void 0===N||null===(f=N.result)||void 0===f?void 0:f.length})}),(0,h.jsx)(x.x4,{children:(0,h.jsx)(o.gC,{align:"flex-start",divider:(0,h.jsx)(o.cX,{}),w:"100%",maxW:"438px",children:(0,h.jsx)(E,{data:Z})})}),(0,h.jsx)(x.x4,{children:(0,h.jsx)(o.gC,{align:"flex-start",divider:(0,h.jsx)(o.cX,{}),w:"100%",maxW:"438px",children:(0,h.jsx)(z,{data:N})})}),(0,h.jsx)(x.x4,{children:(0,h.jsx)(M,{comments:N})})]})]})]})}},3859:function(e,n,r){r.d(n,{s:function(){return s}});var s=function(e){return+(/(?:u\/)?(\d+)/.exec(e||"")||[])[1]||0}}}]);
//# sourceMappingURL=482.5a5fb8b0.chunk.js.map